#:kivy 1.4

# Define your background color Template
<BackgroundColor@Widget>
    background_color: 1, 1, 1, 1
    canvas.before:
        Color:
            rgba: root.background_color
        Rectangle:
            size: self.size
            pos: self.pos

# Now you can simply Mix the `BackgroundColor` class with almost
# any other widget... to give it a background.
<BackgroundLabel@Label+BackgroundColor>
    background_color: 0, 0, 0, 0


<AirborneTouchscreen>:
    tab_pos: 'bottom_left'
    do_default_tab: False
    objP_panOffset:      id_panOffset
    objP_tiltOffset:     id_tiltOffset
    objP_magDecOffset:   id_magDec
    objP_mavLinkStat:    id_mavLinkStat
    objP_flaskStat:      id_flaskStat
    objP_current_time:   id_current_time
    objP_last_telemetry: id_last_telemetry
    objP_program_status: id_program_status
    objP_remote_lat:     id_remote_lat
    objP_remote_lon:     id_remote_lon
    objP_remote_alt:     id_remote_alt
    objP_heading:        id_heading
    objP_tilt:           id_tilt
    objP_distance:       id_distance
    objP_last_baseGPS:   id_last_baseGPS
    objP_antennaCurrent: id_antennaCurrent
    objP_stopNetwork:      id_stopNetwork
    objP_getIPaddress:     id_getIPaddress
    objP_pingGithub:       id_pingGithub
    objP_gitPull:          id_gitPull
    objP_gitVersion:       id_gitVersion

    TabbedPanelItem:
        text: 'Status'
        on_press: root.flskStatusGetAll()
        BoxLayout:
            orientation: 'vertical'
            BoxLayout:
                BoxLayout:
                    orientation: 'vertical'
                    BoxLayout:
                        BackgroundLabel:
                            text: 'Telemetry\n(MAVLink/NMEA)'
                            id: id_mavLinkStat
                            bold: True
                            color: 0, 0, 0, 1
                            background_color: 0, 0, 1, 1
                        BackgroundLabel:
                            text: 'Config Server'
                            id: id_flaskStat
                            bold: True
                            color: 0, 0, 0, 1
                            background_color: 0, 0, 1, 1
                    BoxLayout:
                        BackgroundLabel:
                            text: 'Status'
                        BackgroundLabel:
                            id: id_program_status
                            text: 'No connect'
                    BoxLayout:
                        BackgroundLabel:
                            text: 'Time'
                        BackgroundLabel:
                            id: id_current_time
                            text: 'No connect'
                    BoxLayout:
                        BackgroundLabel:
                            text: 'Last Telemetry'
                        BackgroundLabel:
                            id: id_last_telemetry
                            text: 'No connect'
                    BackgroundLabel:
                        size_hint_y: 2
                        id: id_last_baseGPS
                        text: 'Basestation GPS'
                        color: 0, 0, 0, 1
                        background_color: 0, 0, 1, 1
                BoxLayout:
                    orientation: 'vertical'
                    BoxLayout:
                        BackgroundLabel:
                            text: 'Air Lat'
                        BackgroundLabel:
                            id: id_remote_lat
                            text: 'No connect'
                    BoxLayout:
                        BackgroundLabel:
                            text: 'Air Lon'
                        BackgroundLabel:
                            id: id_remote_lon
                            text: 'No connect'
                    BoxLayout:
                        BackgroundLabel:
                            text: 'Air Alt'
                        BackgroundLabel:
                            id: id_remote_alt
                            text: 'No connect'
                    BoxLayout:
                        BackgroundLabel:
                            text: 'Heading'
                        BackgroundLabel:
                            id: id_heading
                            text: 'No connect'
                    BoxLayout:
                        BackgroundLabel:
                            text: 'Tilt'
                        BackgroundLabel:
                            id: id_tilt
                            text: 'No connect'
                    BoxLayout:
                        BackgroundLabel:
                            text: 'Distance'
                        BackgroundLabel:
                            id: id_distance
                            text: 'No connect'
                    BackgroundLabel:
                        id: id_antennaCurrent
                        text: 'Current Antenna'
                        color: 0, 0, 0, 1
                        background_color: 0, 0, 1, 1
    TabbedPanelItem:
        text: 'Pan Neutral'
        on_press: root.flskCfgGetPan()
        BoxLayout:
            BoxLayout:
                orientation: 'vertical'
                Label:
                    font_size: '30sp'
                    bold: True
                    id: id_panOffset
                    text: 'No connection'
                Switch:
                    id: panSwitch
                Button:
                    text: 'Stop Servo'
                    on_press: root.doStopServos()
                    disabled: False if panSwitch.active else True
                Button:
                    text: 'Start Servo'
                    on_press: root.doStartServos()
                    disabled: False if panSwitch.active else True
            BoxLayout:
                orientation: 'vertical'
                BoxLayout:
                    Button:
                        text: '+1000'
                        on_press: root.panInc(1000)
                    Button:
                        text: '+100'
                        on_press: root.panInc(100)
                    Button:
                        text: '+10'
                        on_press: root.panInc(10)
                BoxLayout:
                    Button:
                        text: '-1000'
                        on_press: root.panInc(-1000)
                    Button:
                        text: '-100'
                        on_press: root.panInc(-100)
                    Button:
                        text: '-10'
                        on_press: root.panInc(-10)
    TabbedPanelItem:
        text: 'Tilt Offset'
        on_press: root.flskCfgGetTilt()
        BoxLayout:
            Label:
                font_size: '30sp'
                bold: True
                id: id_tiltOffset
                text: 'No connection'
            BoxLayout:
                orientation: 'vertical'
                BoxLayout:
                    Button:
                        text: '+10'
                        on_press: root.tiltInc(10*506)
                    Button:
                        text: '+5'
                        on_press: root.tiltInc(5*506)
                    Button:
                        text: '+0.1'
                        on_press: root.tiltInc(0.1*506)
                BoxLayout:
                    Button:
                        text: '-10'
                        on_press: root.tiltInc(-10*506)
                    Button:
                        text: '-5'
                        on_press: root.tiltInc(-5*506)
                    Button:
                        text: '-0.1'
                        on_press: root.tiltInc(-0.1*506)
    TabbedPanelItem:
        text: 'Compass'
        on_press: root.flskCfgGetMag()
        BoxLayout:
            BoxLayout:
                orientation: 'vertical'
                Label:
                    text: 'Magnetic Declination'
                Label:
                    id: id_magDec
                    font_size: '30sp'
                    bold: True
                    text: 'No connection'
            BoxLayout:
                orientation: 'vertical'
                BoxLayout:
                    Button:
                        text: '+10'
                        on_press: root.magDecInc(10)
                    Button:
                        text: '+5'
                        on_press: root.magDecInc(5)
                    Button:
                        text: '+0.1'
                        on_press: root.magDecInc(0.1)
                BoxLayout:
                    Button:
                        text: '-10'
                        on_press: root.magDecInc(-10)
                    Button:
                        text: '-5'
                        on_press: root.magDecInc(-5)
                    Button:
                        text: '-0.1'
                        on_press: root.magDecInc(-0.1)
    TabbedPanelItem:
        font_size: '12sp'
        text: 'Software\nUpdate'
        BoxLayout:
            orientation: 'vertical'
            BackgroundLabel:
                id: id_stopNetwork
                text: 'Stop Network'
                color: 0, 0, 0, 1
                background_color: 0.7, 0.7, 0.7, 1
                disabled: False if dfuSwitch.active else True
            BackgroundLabel:
                id: id_getIPaddress
                text: 'Get IP Address'
                color: 0, 0, 0, 1
                background_color: 0.8, 0.8, 0.8, 1
                disabled: False if dfuSwitch.active else True
            BackgroundLabel:
                id: id_pingGithub
                text: 'Ping Github'
                color: 0, 0, 0, 1
                background_color: 0.7, 0.7, 0.7, 1
                disabled: False if dfuSwitch.active else True
            BackgroundLabel:
                id: id_gitPull
                text: 'Pull from Github'
                color: 0, 0, 0, 1
                background_color: 0.8, 0.8, 0.8, 1
                disabled: False if dfuSwitch.active else True
            BoxLayout:
                Switch:
                    id: dfuSwitch  # Device Firmware Update Switch
                Button:
                    text: 'Update'
                    on_press: root.doSoftwareUpdate()
                    disabled: False if dfuSwitch.active else True
                Button:
                    text: 'Reboot'
                    on_press: root.doReboot()
                    disabled: False if dfuSwitch.active else True
                Button:
                    text: 'Shutdown'
                    on_press: root.doShutdown()
                    disabled: False if dfuSwitch.active else True
            BoxLayout:
                BackgroundLabel:
                    id: id_gitVersion
                    size_hint_x: 4
                    text: 'Site: github.com/bradgrissom/ai_trkAnt_release'

                    text_size: self.width, None
                    #size_hint: 1, None
                    height: self.texture_size[1]

                    color: 0, 0, 0, 1
                    background_color: 1, 1, 1, 1
                Button:
                    text: 'Get\nVersion'
                    on_press: root.getGitVersion()


